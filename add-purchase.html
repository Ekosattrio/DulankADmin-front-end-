<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
    <meta name="description" content="POS - Bootstrap Admin Template">
    <meta name="keywords"
        content="admin, estimates, bootstrap, business, corporate, creative, invoice, html5, responsive, Projects">
    <meta name="author" content="Dreamguys - Bootstrap Admin Template">
    <meta name="robots" content="noindex, nofollow">
    <title>Dreams Pos Admin Template</title>

    <link rel="shortcut icon" type="image/x-icon" href="assets/img/favicon.png">
    <!-- Summernote CSS -->
    <link rel="stylesheet" href="assets/plugins/summernote/summernote-bs4.min.css">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">

    <!-- animation CSS -->
    <link rel="stylesheet" href="assets/css/animate.css">

    <!-- Select2 CSS -->
    <link rel="stylesheet" href="assets/plugins/select2/css/select2.min.css">

    <!-- Datetimepicker CSS -->
    <link rel="stylesheet" href="assets/css/bootstrap-datetimepicker.min.css">

    <!-- Datatable CSS -->
    <link rel="stylesheet" href="assets/css/dataTables.bootstrap5.min.css">

    <!-- Bootstrap Tagsinput CSS -->
    <link rel="stylesheet" href="assets/plugins/bootstrap-tagsinput/bootstrap-tagsinput.css">

    <!-- Fontawesome CSS -->
    <link rel="stylesheet" href="assets/plugins/fontawesome/css/fontawesome.min.css">
    <link rel="stylesheet" href="assets/plugins/fontawesome/css/all.min.css">

    <!-- Main CSS -->
    <link rel="stylesheet" href="assets/css/style.css">
    <style>
        .table-responsive {
    overflow: visible !important; 
}

    </style>

</head>

<body>
    <div id="global-loader">
        <div class="loader"> </div>
    </div>
    <!-- Main Wrapper -->
    <div class="main-wrapper">

        <!-- header -->
        <div id="header-placeholder"></div>
        <!-- sidebar -->
        <div id="sidebar-placeholder"></div>

        <div class="page-wrapper mt-1">
            <!-- Main content tulis disini -->
            <div class="content">

                <div class="page-header mt-5">
                    <div class="add-item d-flex">
                        <div class="page-title">
                            <h4>Add Purchase</h4>
                        </div>
                    </div>
                </div>
                <div class="card border-0 shadow p-5">
                    <div class="card-body pb-0">
                        <div class="row">
                            <div class="col-lg-6 col-sm-6 col-12">
                                <div class="mb-3">
                                    <div class="add-newplus">
                                        <label class="form-label">Customer<span
                                                class="text-danger ms-1">*</span></label>
                                        <a href="javascript:void(0);" data-bs-toggle="modal"
                                            data-bs-target="#add-units-category"><i data-feather="plus-circle"
                                                class="plus-down-add"></i><span>Add
                                                New</span></a>
                                    </div>
                                    <div class="input-groupicon select-code">
                                        <div class="search-container">
                                            <input type="text" class="form-control customer-input"
                                                placeholder="Search Customer">
                                            <div class="search-results"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6 col-sm-6 col-12">
                                    <div class="mb-0">
                                        <strong>PT Cipta Kreasi</strong><br>
                                        <small>ciptakreasi@gmail.com</small><br>
                                        <small>6218 9 6855 554</small><br>
                                        <small>Cyber 2 Tower, Lantai 29, Jalan HR Rasuna Said,<br> X5 No.13, Jakarta
                                            Selatan, 12950</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 col-sm-6 col-12">
                                <div class="mb-2 row align-items-center">
                                    <label class="form-label col-4 mb-0">No Purchase</label>
                                    <div class="col-8">
                                        <input type="text" class="form-control" value="PUR0000001" disabled>
                                    </div>
                                </div>

                                <div class="mb-2 row align-items-center">
                                    <label class="form-label col-4 mb-0">Date</label>
                                    <div class="col-8">
                                        <input type="date" class="form-control" value="25/11/2025">
                                    </div>
                                </div>
                                <div class="row align-items-center">
                                    <label class="form-label col-4 mb-0">Create</label>
                                    <div class="col-8">
                                        <input type="text" class="form-control" value="Sales Staff">
                                    </div>
                                </div>
                            </div>


                        </div>
                        <div class="row mt-3">
                            <div class="col-lg-6 col-sm-6 col-12">
                                <div class="mb-3">
                                    <div class="add-newplus">
                                        <label class="form-label">Customer<span
                                                class="text-danger ms-1">*</span></label>
                                        <a href="javascript:void(0);" data-bs-toggle="modal"
                                            data-bs-target="#add-units-category"><i data-feather="plus-circle"
                                                class="plus-down-add"></i><span>Add
                                                New</span></a>
                                    </div>
                                    <div class="input-groupicon select-code">
                                        <div class="search-container">
                                            <input type="text" class="form-control customer-input"
                                                placeholder="Search Customer">
                                            <div class="search-results"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                       <div class="table-responsive mt-2">
    <table class="table table-bordered align-middle" style="border-color:#ccc;">
        <thead class="table-light">
            <tr>
                <th style="width:40%;">Product Name</th>
                <th>Qty</th>
                <th>Unit</th>
                <th style="width: 150px;">Price (IDR)</th>
                <th>Amount (IDR)</th>
            </tr>
        </thead>
        <tbody>
           
        </tbody>
    </table>
    <div class="inline-block mb-4">
        <a href="javascript:void(0);" class="btnAddNewProduct mt-3 d-inline-block">
            <i data-feather="plus-circle" class="plus-down-add text-primary"></i>
            <span class="text-primary">add New blank</span>
        </a>
    </div>
</div>
                        <div class="row mt-3">
                            <div class="col-4">
                                <div class="input-blocks align-items-center">
                                    <label class="form-label">Purchase Notes</label>
                                    <input type="text" class="form-control">

                                </div>
                            </div>
                            <div class="col-lg-4 offset-4 col-sm-6 col-12">
                                <div class="">
                                    <div class="input-blocks align-items-center">
                                        <label class="form-label">Sub Total</label>
                                        <input type="text" class="form-control">

                                    </div>
                                </div>
                                <div class="mb-3">
                                    <div class="input-blocks align-items-center">
                                        <label class="form-label">tax</label>
                                        <select class="select select-payment">
                                            <option value="credit">Credit Card</option>
                                            <option value="cash" selected>Cash</option>
                                            <option value="cheque">Cheque</option>
                                            <option value="deposit">Deposit</option>
                                            <option value="points">Points</option>
                                        </select>

                                    </div>
                                </div>
                                <div class="mb-3 d-flex justify-content-between total-payment fw-semibold">
                                    <span>Total (IDR)</span>
                                    <span>1.200.000</span>
                                </div>
                            </div>
                        </div>
                       
                    </div>
                </div>
<div class="modal-footer my-5 justify-content-end">

                    <div>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                            Cancel
                        </button>
                        <button class="btn btn-warning">
                            Save Changes
                        </button>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <!-- /Main Wrapper -->
    <!-- modals -->

    <!-- /modals -->
    <!-- jQuery -->
    <script src="assets/js/jquery-3.7.1.min.js"></script>

    <!-- Feather Icon JS -->
    <script src="assets/js/feather.min.js"></script>

    <!-- Slimscroll JS -->
    <script src="assets/js/jquery.slimscroll.min.js"></script>

    <!-- Datatable JS -->
    <script src="assets/js/jquery.dataTables.min.js"></script>
    <script src="assets/js/dataTables.bootstrap5.min.js"></script>

    <!-- Bootstrap Core JS -->
    <script src="assets/js/bootstrap.bundle.min.js"></script>


    <!-- Datetimepicker JS -->
    <script src="assets/js/moment.min.js"></script>
    <script src="assets/js/bootstrap-datetimepicker.min.js"></script>

    <!-- Summernote JS -->
    <script src="assets/plugins/summernote/summernote-bs4.min.js"></script>
    <script src="assets/plugins/summernote/summernote-bs4.min.js"></script>
    <script src="assets/plugins/summernote/summernote-bs4.min.js"></script>
    <!-- Select2 JS -->
    <script src="assets/plugins/select2/js/select2.min.js"></script>

    <!-- Bootstrap Tagsinput JS -->
    <script src="assets/plugins/bootstrap-tagsinput/bootstrap-tagsinput.js"></script>

    <!-- Sweetalert 2 -->
    <script src="assets/plugins/sweetalert/sweetalert2.all.min.js"></script>
    <script src="assets/plugins/sweetalert/sweetalerts.min.js"></script>

    <!-- Separator -->
    <script src="assets/js/easy-number-separator.js"></script>

    <!-- Live Search -->
    <script src="assets/js/liveSearch.js"></script>

    <!-- Custom JS -->
    <script src="assets/js/theme-script.js"></script>
    <script src="assets/js/script.js"></script>

    <!-- js buat id summernote nabrak buatan eko	 -->
    <script>
        $(document).ready(function () {
            $('#summernote-create').summernote({
                placeholder: 'Type description...',
                height: 150
            });

            $('#summernote-edit').summernote({
                placeholder: 'Edit description...',
                height: 150
            });
        });

    </script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
    const masterProducts = [
        { name: "Tinta Neotex 1Kg Cyan", price: "450.000", desc: "Tinta Pigment High Quality" },
        { name: "Kertas Art Paper A4", price: "85.000", desc: "150gr, Glossy" },
        { name: "Sticker Vinyl Putih", price: "120.000", desc: "Waterproof" }
    ];

    function clean(num) {
        if (!num) return 0;
        return parseInt(String(num).replace(/[^\d]/g, "")) || 0;
    }

    function format(num) {
        if (!num || num === 0) return "0";
        return String(num).replace(/\D/g, "").replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    }

    function recalc(row) {
        const qtyEl = row.querySelector(".quntity-input");
        const priceEl = row.querySelector(".price-input");
        const amountEl = row.querySelector(".amount-text");

        if (!qtyEl || !priceEl || !amountEl) return;

        const qty = parseInt(qtyEl.value || "0") || 0;
        const price = clean(priceEl.value || "0");
        const total = qty * price;
        
        amountEl.innerText = format(total);

        const modal = row.closest('.modal');
        if (modal) {
            const btnApply = modal.querySelector('button[onclick*="applyVoucher"]');
            if (btnApply && typeof applyVoucher === "function") applyVoucher(null, btnApply);
        }
    }

    function generateTableTR() {
        return `
        <tr class="product-item">
            <td>
                <div class="product-search-container position-relative">
                    <input type="text" class="form-control product-search-input fw-bold" placeholder="Cari Produk... ketik minimal 3" autocomplete="off">
                    <div class="product-search-results dropdown-menu w-100 shadow-sm"></div>
                </div>
            </td>
            <td>
                <div class="product-quantity" style="width: 100% !important;">
                    <span class="quantity-btn plus-btn"><i data-feather="plus-circle"></i></span>
                    <input type="text" class="quntity-input" value="1">
                    <span class="quantity-btn minus-btn"><i data-feather="minus-circle"></i></span>
                </div>
            </td>
            <td>
                <select class="form-control select mt-1">
                    <option selected>Pcs</option><option>Box</option><option>Set</option>
                </select>
            </td>
            <td><input type="text" class="form-control text-end price-input" value="0"></td>
            <td class="text-end fw-bold">
                <span class="amount-text">0</span>
                <a href="javascript:void(0);" class="delete-row text-danger ms-2"><i data-feather="trash-2" style="width:14px;"></i></a>
            </td>
        </tr>`;
    }

    document.addEventListener("click", function (ev) {
        const target = ev.target;

        // 1. ADD NEW BLANK
        const btnAdd = target.closest(".btnAddNewProduct");
        if (btnAdd) {
            ev.preventDefault();
            const container = btnAdd.closest('.table-responsive').querySelector("tbody");
            if (container) {
                container.insertAdjacentHTML('beforeend', generateTableTR());
                if (window.feather) feather.replace();
            }
            return;
        }

        // 2. DELETE ROW
        const btnDel = target.closest(".delete-row");
        if (btnDel) {
            btnDel.closest("tr").remove();
            return;
        }

        // 3. PILIH PRODUK HASIL SEARCH (FIXED: TUTUP DROPDOWN)
        const resItem = target.closest(".product-item-result");
        if (resItem) {
            const row = resItem.closest("tr");
            const resBox = resItem.parentElement; // Container dropdownnya

            row.querySelector(".product-search-input").value = resItem.dataset.name;
            row.querySelector(".price-input").value = resItem.dataset.price;
            
            // Tutup dropdown
            resBox.classList.remove("show");
            resBox.style.display = "none"; // Paksa tutup biar nggak nge-glitch

            recalc(row);
            return;
        }

        // 4. PLUS MINUS
        const qtyBtn = target.closest(".plus-btn, .minus-btn");
        if (qtyBtn) {
            const row = qtyBtn.closest("tr");
            const input = row.querySelector(".quntity-input");
            let val = parseInt(input.value) || 1;
            input.value = qtyBtn.classList.contains("plus-btn") ? val + 1 : (val > 1 ? val - 1 : 1);
            recalc(row);
            return;
        }

        // KLIK LUAR UNTUK TUTUP
        if (!target.closest(".product-search-container")) {
            document.querySelectorAll(".product-search-results").forEach(box => {
                box.classList.remove("show");
                box.style.display = "none";
            });
        }
    });

    document.addEventListener("input", function (e) {
        const target = e.target;
        const row = target.closest("tr");
        if (!row) return;

        // AUTOCOMPLETE SEARCH
        if (target.classList.contains("product-search-input")) {
            const resBox = target.nextElementSibling;
            const val = target.value.toLowerCase();
            if (val.length >= 3) {
                const matched = masterProducts.filter(p => p.name.toLowerCase().includes(val));
                resBox.innerHTML = matched.map(p => `
                    <div class="product-item-result p-2" data-name="${p.name}" data-price="${p.price}" data-desc="${p.desc}" style="cursor:pointer; border-bottom:1px solid #eee;">
                        <strong>${p.name}</strong><br><small>Rp ${p.price}</small>
                    </div>
                `).join("") || '<div class="p-2 text-muted">No result</div>';
                
                resBox.classList.add("show");
                resBox.style.display = "block"; // Tampilkan eksplisit
            } else {
                resBox.classList.remove("show");
                resBox.style.display = "none";
            }
        }

        if (target.classList.contains("price-input") || target.classList.contains("quntity-input")) {
            if (target.classList.contains("price-input")) target.value = format(target.value);
            recalc(row);
        }
    });
});
</script>


</body>

</html>